<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Arthur & Tifenn</title>
  <style>
    body {
      font-family: sans-serif;
      background: linear-gradient(to bottom, #0d1b2a, #1b263b);
      color: white;
      text-align: center;
      padding: 2rem;
    }
    button {
      padding: 1rem 2rem;
      margin: 1rem;
      font-size: 1.2rem;
      border: none;
      border-radius: 10px;
      background-color: #e0aaff;
      cursor: pointer;
    }
    #results {
      margin-top: 2rem;
      font-size: 1.3rem;
    }
    #next {
      margin-top: 2rem;
      background-color: #c77dff;
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>
</head>
<body>
  <h1>Quiz Arthur & Tifenn ⭐ Nuit étoilée</h1>
  <h2 id="question"></h2>

  <button onclick="sendVote(currentQuestionId, 'Arthur')">Arthur</button>
  <button onclick="sendVote(currentQuestionId, 'Tifenn')">Tifenn</button>

  <div id="results">Chargement des résultats...</div>
  <button id="next" onclick="nextQuestion()">Suivant</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC2Z8_g3rGC1feDmQypaHk4zxCBvZ4otZI",
      authDomain: "quiz-arthur-et-tif.firebaseapp.com",
      databaseURL: "https://quiz-arthur-et-tif-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "quiz-arthur-et-tif",
      storageBucket: "quiz-arthur-et-tif.firebasestorage.app",
      messagingSenderId: "1087201359678",
      appId: "1:1087201359678:web:a17f4b747404e205ba9e6f",
      measurementId: "G-SNSH465T79"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const questions = [
      "Qui a eu le coup de foudre en premier ?",
      "Qui est le plus en retard ?",
      "Qui a le plus de fringues ?",
      "Qui est le plus têtu ?",
      "Qui a la meilleure mémoire ?",
      "Qui est le plus organisé ?",
      "Qui est le plus asociable ?",
      "Qui va vers l’autre après une dispute ?",
      "Qui prend le plus de place au lit ?",
      "Qui est le plus stressé aujourd’hui?",
      "Qui porte la culotte dans le couple ?",
      "Qui passe le plus de temps aux toilettes ?",
      "Qui cuisine le mieux ?",
      "Qui est le plus dépensier ?",
      "Qui a le plus menti durant ce questionnaire ?"
    ];

    let currentIndex = 0;
    let currentQuestionId = "q1";

    function showQuestion(index) {
      currentQuestionId = `q${index + 1}`;
      document.getElementById("question").textContent = questions[index];
      listenToResults(currentQuestionId);
    }

    function sendVote(questionId, answer) {
      const voteRef = database.ref("votes/" + questionId + "/" + answer);
      voteRef.transaction(current => (current || 0) + 1);
    }

    function listenToResults(questionId) {
      const ref = database.ref("votes/" + questionId);
      ref.on("value", (snapshot) => {
        const data = snapshot.val() || {};
        const arthur = data['Arthur'] || 0;
        const tifenn = data['Tifenn'] || 0;

        document.getElementById("results").innerHTML =
          `<p>Arthur : ${arthur} vote(s)</p>
           <p>Tifenn : ${tifenn} vote(s)</p>`;
      });
    }

    function nextQuestion() {
      currentIndex++;
      if (currentIndex < questions.length) {
        showQuestion(currentIndex);
      } else {
        document.getElementById("question").textContent = "Merci pour votre participation ✨";
        document.getElementById("results").innerHTML = "<p>Fin du quiz</p>";
        document.getElementById("next").style.display = "none";
      }
    }

    // Initialiser la première question
    showQuestion(currentIndex);
  </script>
</body>
</html>
